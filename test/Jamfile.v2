#          Copyright Tom Westerhout 2017.
# Distributed under the Boost Software License, Version 1.0.
#    (See accompanying file LICENSE_1_0.txt or copy at
#          http://www.boost.org/LICENSE_1_0.txt)

import testing ;
import os ;
import path ;

local boost-root = [ os.environ BOOST_ROOT ] ;

project static_views 
    : requirements <include>../include
                   <include>$(boost-root)
                   <warnings>all
                   <toolset>gcc:<cxxflags>"-std=c++14"
                   <toolset>msvc:<cxxflags>"/std:c++14"
                   <toolset>clang:<cxxflags>"-std=c++14 -stdlib=libc++"
                   <toolset>clang:<linkflags>"-lc++"
    ;


local test-optimisation = [ path.native ./test_optimisation.py ] ;

test-suite static_views_tests :
    [ run correctness/test_invoke.cpp ]
    [ run correctness/test_raw_view.cpp ]
    [ compile drop/test_create.cpp ]
    [ compile drop/test_size.cpp ]
    [ run drop/test_nested.cpp
        : # args *
        : # input-files *
        : # requirements *
          <variant>release
          <testing.launcher>"$(test-optimisation) test1"
    ]
    ;

alias minimal : static_views_tests ;
alias ful     : static_views_tests ;
alias extra   : static_views_tests ;
